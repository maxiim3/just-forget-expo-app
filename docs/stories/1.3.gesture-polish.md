# Story 1.3: Gesture Polish

## Status
Draft

## Story
**As a** user swiping through my thought cards,
**I want** gestures to feel snappy, responsive, and delightful,
**so that** the core interaction feels polished and professional (9/10 rating).

## Acceptance Criteria

1. Swipe gestures feel snappy with appropriate snap-back timing
2. Gesture sensitivity is tuned for comfortable use (not too sensitive, not too sluggish)
3. Spring bounce animation feels natural and satisfying
4. Rotation during swipe feels subtle and intentional
5. Direction detection is reliable (no accidental diagonal triggers)
6. Gesture behavior is consistent across Web, iOS, and Android
7. Final gesture configuration is documented for future reference
8. Product Owner rates gesture feel as 9/10 or higher

## Tasks / Subtasks

- [ ] Task 1: Audit current gesture parameters (AC: 7)
  - [ ] Document current values in GestureCard.tsx
  - [ ] Document current values in constants/theme.ts
  - [ ] Create baseline test recording (if possible)

- [ ] Task 2: Tune swipe threshold and velocity (AC: 1, 2)
  - [ ] Experiment with SWIPE_THRESHOLD (current: 50)
  - [ ] Experiment with VELOCITY_THRESHOLD (current: 300)
  - [ ] Test quick flicks vs deliberate swipes
  - [ ] Find optimal balance

- [ ] Task 3: Tune spring animation (AC: 3)
  - [ ] Experiment with spring damping (current: 15)
  - [ ] Experiment with spring stiffness (current: 150)
  - [ ] Test snap-back feel on cancel
  - [ ] Consider different spring configs for different actions

- [ ] Task 4: Tune rotation during swipe (AC: 4)
  - [ ] Experiment with rotation interpolation range (current: [-8, 0, 8] degrees)
  - [ ] Experiment with translation range (current: [-150, 0, 150])
  - [ ] Ensure rotation feels natural, not exaggerated

- [ ] Task 5: Tune direction detection (AC: 5)
  - [ ] Experiment with DIRECTION_LOCK_RATIO (current: 0.6)
  - [ ] Test diagonal rejection reliability
  - [ ] Ensure cardinal directions are easily achievable

- [ ] Task 6: Cross-platform testing (AC: 6)
  - [ ] Test on Web (Chrome, Safari, Firefox)
  - [ ] Test on iOS (Expo Go or Simulator)
  - [ ] Test on Android (Expo Go or Emulator)
  - [ ] Document any platform-specific differences

- [ ] Task 7: Stack visualization tuning (optional) (AC: 1)
  - [ ] Review stackOffset (current: 16)
  - [ ] Review stackScale (current: 0.97)
  - [ ] Review opacityBase (current: 0.88)
  - [ ] Adjust if needed for better depth perception

- [ ] Task 8: Document final configuration (AC: 7)
  - [ ] Add comments to GestureCard.tsx explaining each parameter
  - [ ] Create gesture-config section in architecture docs (if created)
  - [ ] Note any platform-specific adjustments

- [ ] Task 9: Product Owner review (AC: 8)
  - [ ] Demo gesture feel to PO
  - [ ] Collect feedback and rating
  - [ ] Iterate if needed until 9/10 achieved

## Dev Notes

### Current Gesture Parameters

**GestureCard.tsx (lines 14-16):**
```typescript
const SWIPE_THRESHOLD = 50;        // Min distance to trigger swipe
const VELOCITY_THRESHOLD = 300;    // Min velocity to trigger swipe
const DIRECTION_LOCK_RATIO = 0.6;  // Direction purity (0.6 = 60% in one axis)
```

**Spring Animation (lines 125-127):**
```typescript
withSpring(0, { damping: 15, stiffness: 150 })
```

**Rotation Interpolation (lines 106-110):**
```typescript
rotation.value = interpolate(
  event.translationX,
  [-150, 0, 150],  // Translation range
  [-8, 0, 8]       // Rotation degrees
);
```

**Stack Visualization (constants/theme.ts):**
```typescript
cardDimensions = {
  stackOffset: 16,      // Vertical offset per card
  stackScale: 0.97,     // Scale reduction per level
  opacityBase: 0.88,    // Opacity reduction per level
}
```

### File Locations
- Gesture logic: `components/cards/GestureCard.tsx`
- Card stack: `components/cards/CardStack.tsx`
- Theme constants: `constants/theme.ts`

### Spring Animation Reference
React Native Reanimated spring config:
- **damping**: Higher = less bouncy (15 is moderate)
- **stiffness**: Higher = faster spring (150 is moderate-fast)
- Consider: `{ damping: 20, stiffness: 200 }` for snappier feel
- Consider: `{ damping: 12, stiffness: 120 }` for bouncier feel

### Testing Tips
- Test with real finger/touch, not just mouse
- Test quick flicks vs slow deliberate swipes
- Test diagonal gestures to ensure they're rejected
- Test edge cases (very small movements, very fast swipes)

### Platform Considerations
- Web: May feel different with mouse vs touch
- iOS: Generally smoother gesture handling
- Android: May need slight threshold adjustments

## Testing

### Manual Testing Required
- [ ] Quick flick right → Edit overlay appears, action triggers
- [ ] Slow deliberate swipe → Feels responsive, not sluggish
- [ ] Cancel swipe (don't complete) → Snaps back smoothly
- [ ] Diagonal swipe → No accidental triggers
- [ ] Multiple rapid swipes → No lag or stutter
- [ ] Swipe at edge of card → Works same as center

### Platforms to Test
- Web (Chrome) - primary
- Web (Safari)
- iOS Expo Go
- Android Expo Go

### Subjective Quality Metrics
| Metric | Target |
|--------|--------|
| Snap-back speed | Fast but not jarring |
| Bounce feel | Subtle, satisfying |
| Rotation | Noticeable but not excessive |
| Sensitivity | Responsive but not twitchy |
| Overall feel | "Delightful" |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-08 | 0.1 | Initial draft | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used
_To be filled by dev agent_

### Debug Log References
_To be filled by dev agent_

### Completion Notes List
_To be filled by dev agent_

### File List
_To be filled by dev agent_

---

## QA Results
_To be filled by QA agent_
